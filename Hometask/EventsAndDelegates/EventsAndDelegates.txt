. Метод расширения GetMax:
Принимает коллекцию IEnumerable<T> и делегат Func<T, float>

Преобразует каждый элемент в число с помощью делегата

Находит и возвращает элемент с максимальным значением

Обрабатывает пустые коллекции и null-значения

2. Класс FileSearcher:
Использует событие FileFound типа EventHandler<FileArgs>

FileArgs наследуется от EventArgs и содержит:

FileName - имя найденного файла

CancelSearch - флаг для отмены дальнейшего поиска

Поддерживает рекурсивный обход директорий

Обрабатывает исключения доступа

3. Обработка событий:
Демонстрирует два разных сценария:

Отмена поиска при нахождении .txt файла

Отмена поиска после нахождения 5 файлов

Показывает, как обработчик события может управлять процессом поиска

4. Демонстрационный класс Product:
Показывает использование GetMax с разными критериями

Делегаты для поиска по цене, весу и длине названия

Особенности реализации:
Безопасность: Проверка null-аргументов, обработка исключений

Гибкость: Делегаты позволяют использовать любые критерии сравнения

Расширяемость: Легко добавить новые критерии поиска или обработчики событий

Следование соглашениям .NET: Правильное использование EventArgs и шаблона событий

Программа выводит в консоль все этапы работы, 
что позволяет наглядно увидеть работу как делегатов (при поиске максимального элемента),
так и событий (при поиске файлов).

------------
Ключевые демонстрации продвинутых инструментов:
1. Разные типы делегатов:
Func<T, TResult> - для методов с возвращаемым значением

Action<T> - для методов без возвращаемого значения

Predicate<T> - для методов, возвращающих bool

Кастомные делегаты (ConvertToNumberDelegate<T>, FileFoundDelegate)

Делегаты с ковариантностью/контравариантностью (AdvancedConverter<in TInput, out TResult>)

2. Функции расширения:
GetMax - основная функция из задания

GetMaxWithCustomDelegate - использование кастомного делегата

GetMaxBy - обобщенная версия с поддержкой любых типов

WhereWithPredicate - использование предиката

ConvertAll - демонстрация ковариантности

Compose - композиция функций

3. Продвинутые техники:
Многоадресные делегаты - несколько обработчиков одного события

Цепочки делегатов - последовательное выполнение операций

Мемоизация - кэширование результатов функций

Fluent Interface - цепочки вызовов методов

Анонимные методы и лямбды - различные способы создания делегатов

4. Паттерны проектирования:
Observer Pattern через события

Strategy Pattern через передачу делегатов как параметров

Template Method с использованием делегатов для кастомизации

5. Особенности C#:
Ковариантность (out) и контравариантность (in) в делегатах

Null-conditional оператор (?.) для безопасного вызова событий

Именованные параметры и опциональные параметры

Yield return для ленивых вычислений
-------
1. Основные компоненты:
Кастомные делегаты разных типов (Func, Action, Predicate, собственные делегаты)

Класс FileArgs для передачи информации о найденных файлах (наследуется от EventArgs)

AdvancedFileSearcher - класс для поиска файлов с событиями

AdvancedCollectionExtensions - методы расширения для коллекций

DelegateExtensions - методы расширения для работы с делегатами

Демонстрационные классы Product и Employee

2. Демонстрируемые возможности:
Функции расширения:
GetMax() - поиск максимального элемента с использованием делегата

GetMaxBy() - обобщенный поиск с поддержкой любых типов

WhereWithPredicate() - фильтрация с использованием предиката

ConvertAll() - преобразование с ковариантностью/контравариантностью

События и делегаты:
Стандартный шаблон событий .NET (EventHandler<T>)

Делегаты Action и Func

Кастомные делегаты

Многоадресные делегаты (поддержка += и -=)

Композиция делегатов

Мемоизация (кэширование результатов)

Замыкания (closures)

3. Особенности реализации:
Отмена поиска файлов из обработчика события

Применение фильтров через предикаты

Обработка исключений при работе с файловой системой

Fluent interface для цепочек вызовов

Использование yield return для ленивых вычислений

4. Выходные данные программы:
Программа выводит в консоль:

Результаты поиска максимальных элементов в коллекции товаров

Информацию о найденных файлах с деталями (имя, размер, дата создания)

Демонстрацию работы разных типов делегатов

Примеры композиции функций, мемоизации и замыканий

5. Требования:
.NET 8.0 или выше (используется современный синтаксис C#)

Доступ к файловой системе для демонстрации поиска файлов

Программа является полной демонстрацией использования делегатов и событий в C#,
 охватывающей как базовые, так и продвинутые техники работы с этими конструкциями.
---
Ключевые особенности реализации:
1. Полная биржевая тематика:
Quotes - котировки со спредом и объемом

Trades - детализированные сделки

Orders - ордера разных типов (рыночные, лимитные, стоп)

Positions - позиции с расчетом PnL

Strategies - торговые стратегии (импульс, возврат к среднему)

Exchanges - симулятор биржи с состояниями рынка

TradingContext - контекст торговли с капиталом и позициями

Signals - торговые сигналы с силой и уверенностью

Bars - свечные данные с таймфреймами

2. Продвинутое использование делегатов:
Кастомные делегаты для всех событий системы

Композиция делегатов для создания сложных стратегий

Цепочки проверок риска через делегаты

Мемоизация для кэширования данных

Троттлинг событий для контроля частоты

Фильтрация делегатов с предикатами

3. Функции расширения:
Технические индикаторы (ATR, Bollinger Bands, скользящие средние)

Расширенные расчеты риска и доходности

Комбинирование сигналов с различными стратегиями

Расширения для делегатов с композицией и цепочками

4. Событийная архитектура:
Полная цепочка событий от котировок до позиций

Отмена и фильтрация через обработчики событий

Асинхронные обработчики с async/await

Потокобезопасные коллекции для конкурентного доступа

5. Реализованные функции:
Симулятор биржи с динамическими ценами

Торговый движок с проверками риска

Стратегии импульса и возврата к среднему

Расчет проскальзывания и маржи

Мониторинг в реальном времени

Контекст торговли с капиталом и PnL

6. Использование современных возможностей C# .NET 10:
Records для неизменяемых данных

Pattern matching

Async/await по всей системе

Nullable reference types

Top-level statements (в демо-программе)

Global using directives (можно добавить)

7. Демонстрация работы:
Запуск симуляции рынка

Отправка тестовых ордеров

Генерация сигналов стратегиями

Мониторинг позиций и PnL

Демонстрация функций расширения
Эта система демонстрирует профессиональный подход к созданию торговых систем
 с использованием всех возможностей делегатов, событий и функций расширения в C# .NET 10.

Исправления и улучшения:
1. Исправлена ошибка с record Position:
Заменен метод UpdatePrice() на WithUpdatedPrice(), который возвращает новый экземпляр

Добавлены методы WithIncreasedQuantity() и WithDecreasedQuantity() для корректного обновления позиций

Теперь все методы возвращают новые экземпляры, что соответствует принципам иммутабельности records

2. Добавлены новые события:
PositionClosed - событие закрытия позиции

Более детальное логирование всех операций

3. Улучшена логика управления позициями:
Обработка увеличения позиции

Обработка частичного закрытия

Обработка инверсии позиции (переход из лонга в шорт и наоборот)

Корректный расчет средней цены при добавлении к позиции

4. Обновлен TradingContext:
Добавлен метод RemovePosition() для удаления позиций

Улучшен метод UpdatePosition() для работы с несколькими позициями по одному символу

5. Исправлены типы данных в Random:
Добавлено явное приведение (decimal)_random.NextDouble() вместо неявного

Теперь код полностью работоспособен и демонстрирует профессиональную биржевую систему с использованием всех возможностей C# .NET 10, включая records, делегаты, события и функции расширения.


